const l=require("express"),s=require("fs"),r=require("path"),n=l.Router();n.get("/ultimo",(h,o)=>{try{const e=r.join(__dirname,"../history");if(!s.existsSync(e))return o.json({ok:!1,message:"No hay historial"});const i=s.readdirSync(e).filter(t=>t.endsWith(".json")).map(t=>({name:t,time:s.statSync(r.join(e,t)).mtime.getTime()})).sort((t,m)=>m.time-t.time);if(i.length===0)return o.json({ok:!1,message:"No hay historial"});const a=r.join(e,i[0].name),c=JSON.parse(s.readFileSync(a,"utf-8"));o.json({ok:!0,data:c})}catch(e){console.error(e),o.status(500).json({ok:!1,message:"Error leyendo historial"})}}),module.exports=n;
